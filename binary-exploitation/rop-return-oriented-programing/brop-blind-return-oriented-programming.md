# BROP - Blind Return Oriented Programming

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

ã“ã®æ”»æ’ƒã®ç›®çš„ã¯ã€**è„†å¼±ãªãƒã‚¤ãƒŠãƒªã«é–¢ã™ã‚‹æƒ…å ±ãŒãªãã¦ã‚‚ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’ä»‹ã—ã¦ROPã‚’æ‚ªç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨**ã§ã™ã€‚\
ã“ã®æ”»æ’ƒã¯ä»¥ä¸‹ã®ã‚·ãƒŠãƒªã‚ªã«åŸºã¥ã„ã¦ã„ã¾ã™ï¼š

* ã‚¹ã‚¿ãƒƒã‚¯ã®è„†å¼±æ€§ã¨ãã‚Œã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹æ–¹æ³•ã®çŸ¥è­˜ã€‚
* ã‚¯ãƒ©ãƒƒã‚·ãƒ¥å¾Œã«å†èµ·å‹•ã™ã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

## æ”»æ’ƒ

### **1. è„†å¼±ãªã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’è¦‹ã¤ã‘ã‚‹** ã‚µãƒ¼ãƒãƒ¼ã®ç•°å¸¸ãŒæ¤œå‡ºã•ã‚Œã‚‹ã¾ã§1æ–‡å­—å¤šãé€ä¿¡ã™ã‚‹

### **2. ã‚«ãƒŠãƒªã‚¢ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹** ã—ã¦æ¼æ´©ã•ã›ã‚‹

### **3. ã‚¹ã‚¿ãƒƒã‚¯å†…ã®ä¿å­˜ã•ã‚ŒãŸRBPã¨RIP** ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã—ã¦æ¼æ´©ã•ã›ã‚‹

ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚»ã‚¹ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±ã¯ã€[ã“ã¡ã‚‰ (BF Forked & Threaded Stack Canaries)](../common-binary-protections-and-bypasses/stack-canaries/bf-forked-stack-canaries.md)ãŠã‚ˆã³[ã“ã¡ã‚‰ (BF Addresses in the Stack)](../common-binary-protections-and-bypasses/pie/bypassing-canary-and-pie.md)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### **4. åœæ­¢ã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’è¦‹ã¤ã‘ã‚‹**

ã“ã®ã‚¬ã‚¸ã‚§ãƒƒãƒˆã¯åŸºæœ¬çš„ã«ã€ROPã‚¬ã‚¸ã‚§ãƒƒãƒˆã«ã‚ˆã£ã¦ä½•ã‹èˆˆå‘³æ·±ã„ã‚‚ã®ãŒå®Ÿè¡Œã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã€å®Ÿè¡ŒãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã‹ã£ãŸã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚é€šå¸¸ã€ã“ã®ã‚¬ã‚¸ã‚§ãƒƒãƒˆã¯**å®Ÿè¡Œã‚’åœæ­¢ã™ã‚‹**ã‚‚ã®ã§ã‚ã‚Šã€ç‰¹å®šã®ROPã‚¬ã‚¸ã‚§ãƒƒãƒˆãŒå®Ÿè¡Œã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ROPãƒã‚§ãƒ¼ãƒ³ã®æœ€å¾Œã«é…ç½®ã•ã‚Œã¾ã™ã€‚

### **5. BROPã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’è¦‹ã¤ã‘ã‚‹**

ã“ã®æŠ€è¡“ã¯[**ret2csu**](ret2csu.md)ã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ã„ãã¤ã‹ã®å‘½ä»¤ã®é€”ä¸­ã§ã“ã®ã‚¬ã‚¸ã‚§ãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€**`rsi`**ã¨**`rdi`**ã‚’åˆ¶å¾¡ã™ã‚‹ã‚¬ã‚¸ã‚§ãƒƒãƒˆãŒå¾—ã‚‰ã‚Œã‚‹ãŸã‚ã§ã™ï¼š

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt="" width="278"><figcaption><p><a href="https://www.scs.stanford.edu/brop/bittau-brop.pdf">https://www.scs.stanford.edu/brop/bittau-brop.pdf</a></p></figcaption></figure>

ã“ã‚Œã‚‰ãŒã‚¬ã‚¸ã‚§ãƒƒãƒˆã§ã™ï¼š

* `pop rsi; pop r15; ret`
* `pop rdi; ret`

ã“ã‚Œã‚‰ã®ã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€é–¢æ•°ã‚’å‘¼ã³å‡ºã™ãŸã‚ã®**2ã¤ã®å¼•æ•°ã‚’åˆ¶å¾¡**ã§ãã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

ã¾ãŸã€ret2csuã‚¬ã‚¸ã‚§ãƒƒãƒˆã¯**éå¸¸ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚·ã‚°ãƒãƒãƒ£**ã‚’æŒã£ã¦ã„ã‚‹ãŸã‚ã€ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰6ã¤ã®ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ãƒãƒƒãƒ—ã—ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€æ¬¡ã®ã‚ˆã†ãªãƒã‚§ãƒ¼ãƒ³ã‚’é€ä¿¡ã—ã¾ã™ï¼š

`'A' * offset + canary + rbp + ADDR + 0xdead * 6 + STOP`

**STOPãŒå®Ÿè¡Œã•ã‚Œã‚‹**å ´åˆã€ã“ã‚Œã¯åŸºæœ¬çš„ã«**ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰6ã¤ã®ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ãƒãƒƒãƒ—ã™ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹**ãŒä½¿ç”¨ã•ã‚ŒãŸã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ã¾ãŸã¯ã€ä½¿ç”¨ã•ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚STOPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚ã£ãŸã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

ã“ã®æœ€å¾Œã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’**æ’é™¤ã™ã‚‹ãŸã‚ã«**ã€æ¬¡ã®ã‚ˆã†ãªæ–°ã—ã„ãƒã‚§ãƒ¼ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã€å‰ã®ã‚‚ã®ãŒ6ã¤ã®ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ãƒãƒƒãƒ—ã—ãŸã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«STOPã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¦ã¯ãªã‚Šã¾ã›ã‚“ï¼š

`'A' * offset + canary + rbp + ADDR`

ret2csuã‚¬ã‚¸ã‚§ãƒƒãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’çŸ¥ã£ã¦ã„ã‚‹ã¨ã€**`rsi`ã¨`rdi`ã‚’åˆ¶å¾¡ã™ã‚‹ã‚¬ã‚¸ã‚§ãƒƒãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ¨æ¸¬ã™ã‚‹**ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

### 6. PLTã‚’è¦‹ã¤ã‘ã‚‹

PLTãƒ†ãƒ¼ãƒ–ãƒ«ã¯0x400000ã‹ã‚‰ã€ã¾ãŸã¯ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ã®**æ¼æ´©ã—ãŸRIPã‚¢ãƒ‰ãƒ¬ã‚¹**ã‹ã‚‰æ¤œç´¢ã§ãã¾ã™ï¼ˆ**PIE**ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã®**ã‚¨ãƒ³ãƒˆãƒª**ã¯**16B**ï¼ˆ0x10Bï¼‰ã§åŒºåˆ‡ã‚‰ã‚Œã¦ãŠã‚Šã€1ã¤ã®é–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã€å¼•æ•°ãŒæ­£ã—ããªãã¦ã‚‚ã‚µãƒ¼ãƒãƒ¼ã¯ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¾ã›ã‚“ã€‚ã¾ãŸã€**PLTã®ã‚¨ãƒ³ãƒˆãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ + 6Bã‚‚ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¾ã›ã‚“**ã€‚ã“ã‚Œã¯æœ€åˆã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚

ã—ãŸãŒã£ã¦ã€æ¬¡ã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§PLTãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

* `'A' * offset + canary + rbp + ADDR + STOP` -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„
* `'A' * offset + canary + rbp + (ADDR + 0x6) + STOP` -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„
* `'A' * offset + canary + rbp + (ADDR + 0x10) + STOP` -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„

### 7. strcmpã‚’è¦‹ã¤ã‘ã‚‹

**`strcmp`**é–¢æ•°ã¯ã€æ¯”è¼ƒã•ã‚Œã‚‹æ–‡å­—åˆ—ã®é•·ã•ã‚’ãƒ¬ã‚¸ã‚¹ã‚¿**`rdx`**ã«è¨­å®šã—ã¾ã™ã€‚**`rdx`**ã¯**3ç•ªç›®ã®å¼•æ•°**ã§ã‚ã‚Šã€å¾Œã§`write`ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¼æ´©ã•ã›ã‚‹ãŸã‚ã«**0ã‚ˆã‚Šå¤§ãã„**å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

**`strcmp`**ã®PLTå†…ã®ä½ç½®ã‚’ã€ãã®å‹•ä½œã«åŸºã¥ã„ã¦è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€é–¢æ•°ã®æœ€åˆã®2ã¤ã®å¼•æ•°ã‚’åˆ¶å¾¡ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼š

* strcmp(\<éèª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>, \<éèª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>) -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥
* strcmp(\<éèª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>, \<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>) -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥
* strcmp(\<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>, \<éèª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>) -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥
* strcmp(\<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>, \<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>) -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„

ã“ã‚Œã¯ã€PLTãƒ†ãƒ¼ãƒ–ãƒ«ã®å„ã‚¨ãƒ³ãƒˆãƒªã‚’å‘¼ã³å‡ºã™ã‹ã€**PLTã‚¹ãƒ­ãƒ¼ãƒ‘ã‚¹**ã‚’ä½¿ç”¨ã—ã¦ç¢ºèªã§ãã¾ã™ã€‚ã“ã‚Œã¯åŸºæœ¬çš„ã«**PLTãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¨ãƒ³ãƒˆãƒªã‚’å‘¼ã³å‡ºã— + 0xb**ï¼ˆ**`dlresolve`**ã‚’å‘¼ã³å‡ºã™ï¼‰ã—ã€ãã®å¾Œã‚¹ã‚¿ãƒƒã‚¯ã«**èª¿æŸ»ã—ãŸã„ã‚¨ãƒ³ãƒˆãƒªç•ªå·**ï¼ˆã‚¼ãƒ­ã‹ã‚‰å§‹ã¾ã‚‹ï¼‰ã‚’é…ç½®ã—ã¦ã€æœ€åˆã®ã‚¨ãƒ³ãƒˆãƒªã‹ã‚‰ã™ã¹ã¦ã®PLTã‚¨ãƒ³ãƒˆãƒªã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™ï¼š

* strcmp(\<éèª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>, \<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>) -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥
* `b'A' * offset + canary + rbp + (BROP + 0x9) + RIP + (BROP + 0x7) + p64(0x300) + p64(0x0) + (PLT + 0xb ) + p64(ENTRY) + STOP` -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¾ã™
* strcmp(\<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>, \<éèª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>) -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥
* `b'A' * offset + canary + rbp + (BROP + 0x9) + p64(0x300) + (BROP + 0x7) + RIP + p64(0x0) + (PLT + 0xb ) + p64(ENTRY) + STOP`
* strcmp(\<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>, \<èª­ã¿å–ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹>) -> ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„
* `b'A' * offset + canary + rbp + (BROP + 0x9) + RIP + (BROP + 0x7) + RIP + p64(0x0) + (PLT + 0xb ) + p64(ENTRY) + STOP`

è¦šãˆã¦ãŠã„ã¦ãã ã•ã„ï¼š

* BROP + 0x7ã¯**`pop RSI; pop R15; ret;`**ã‚’æŒ‡ã—ã¾ã™
* BROP + 0x9ã¯**`pop RDI; ret;`**ã‚’æŒ‡ã—ã¾ã™
* PLT + 0xbã¯**dl\_resolve**ã¸ã®å‘¼ã³å‡ºã—ã‚’æŒ‡ã—ã¾ã™ã€‚

`strcmp`ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã§ã€**`rdx`**ã‚’0ã‚ˆã‚Šå¤§ãã„å€¤ã«è¨­å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

{% hint style="success" %}
é€šå¸¸ã€`rdx`ã«ã¯ã™ã§ã«0ã‚ˆã‚Šå¤§ãã„å€¤ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯å¿…è¦ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
{% endhint %}

### 8. Writeã¾ãŸã¯åŒç­‰ã®ã‚‚ã®ã‚’è¦‹ã¤ã‘ã‚‹

æœ€å¾Œã«ã€ãƒã‚¤ãƒŠãƒªã‚’æ¼æ´©ã•ã›ã‚‹ãŸã‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’å¤–éƒ¨ã«é€ä¿¡ã™ã‚‹ã‚¬ã‚¸ã‚§ãƒƒãƒˆãŒå¿…è¦ã§ã™ã€‚ãã—ã¦ã€ã“ã®æ™‚ç‚¹ã§**2ã¤ã®å¼•æ•°ã‚’åˆ¶å¾¡ã—ã€`rdx`ã‚’0ã‚ˆã‚Šå¤§ããè¨­å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚**

ã“ã‚Œã«æ‚ªç”¨ã§ãã‚‹ä¸€èˆ¬çš„ãªé–¢æ•°ã¯3ã¤ã‚ã‚Šã¾ã™ï¼š

* `puts(data)`
* `dprintf(fd, data)`
* `write(fd, data, len(data)`

ãŸã ã—ã€å…ƒã®è«–æ–‡ã§ã¯**`write`**ã®ã¿ãŒè¨€åŠã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã“ã‚Œã«ã¤ã„ã¦è©±ã—ã¾ã—ã‚‡ã†ï¼š

ç¾åœ¨ã®å•é¡Œã¯ã€**PLTå†…ã®writeé–¢æ•°ãŒã©ã“ã«ã‚ã‚‹ã‹**ãŒã‚ã‹ã‚‰ãšã€**ãƒ‡ãƒ¼ã‚¿ã‚’ã‚½ã‚±ãƒƒãƒˆã«é€ä¿¡ã™ã‚‹ãŸã‚ã®fdç•ªå·ãŒã‚ã‹ã‚‰ãªã„**ã“ã¨ã§ã™ã€‚

ã—ã‹ã—ã€**PLTãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½ç½®ã¯ã‚ã‹ã£ã¦ãŠã‚Š**ã€ãã®**å‹•ä½œ**ã«åŸºã¥ã„ã¦writeã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã¾ãŸã€ã‚µãƒ¼ãƒãƒ¼ã¨ã®**è¤‡æ•°ã®æ¥ç¶š**ã‚’ä½œæˆã—ã€**é«˜ã„FD**ã‚’ä½¿ç”¨ã—ã¦ã€ã„ãã¤ã‹ã®æ¥ç¶šã«ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’æœŸå¾…ã§ãã¾ã™ã€‚

ã“ã‚Œã‚‰ã®é–¢æ•°ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã®å‹•ä½œã‚·ã‚°ãƒãƒãƒ£ï¼š

* `'A' * offset + canary + rbp + (BROP + 0x9) + RIP + (BROP + 0x7) + p64(0) + p64(0) + (PLT + 0xb) + p64(ENTRY) + STOP` -> ãƒ‡ãƒ¼ã‚¿ãŒå°åˆ·ã•ã‚Œã‚‹å ´åˆã€putsãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ
* `'A' * offset + canary + rbp + (BROP + 0x9) + FD + (BROP + 0x7) + RIP + p64(0x0) + (PLT + 0xb) + p64(ENTRY) + STOP` -> ãƒ‡ãƒ¼ã‚¿ãŒå°åˆ·ã•ã‚Œã‚‹å ´åˆã€dprintfãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ
* `'A' * offset + canary + rbp + (BROP + 0x9) + RIP + (BROP + 0x7) + (RIP + 0x1) + p64(0x0) + (PLT + 0xb ) + p64(STRCMP ENTRY) + (BROP + 0x9) + FD + (BROP + 0x7) + RIP + p64(0x0) + (PLT + 0xb) + p64(ENTRY) + STOP` -> ãƒ‡ãƒ¼ã‚¿ãŒå°åˆ·ã•ã‚Œã‚‹å ´åˆã€writeãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ

## è‡ªå‹•ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ

* [https://github.com/Hakumarachi/Bropper](https://github.com/Hakumarachi/Bropper)

## å‚è€ƒæ–‡çŒ®

* å…ƒã®è«–æ–‡: [https://www.scs.stanford.edu/brop/bittau-brop.pdf](https://www.scs.stanford.edu/brop/bittau-brop.pdf)
* [https://www.ctfrecipes.com/pwn/stack-exploitation/arbitrary-code-execution/code-reuse-attack/blind-return-oriented-programming-brop](https://www.ctfrecipes.com/pwn/stack-exploitation/arbitrary-code-execution/code-reuse-attack/blind-return-oriented-programming-brop)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
